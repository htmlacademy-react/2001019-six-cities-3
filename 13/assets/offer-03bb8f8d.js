import{r as _,j as e,u as g,a as c,b as w,p as b,d as u,c as y,e as N,f as O,h as I,i as R,k as M,s as A,m as L,n as C,o as S,q as D,t as P,E as T,C as v,L as E,v as Y,w as k,x as F,A as $,M as G,O as H}from"./index-8f900b68.js";const U=r=>e.jsx("div",{className:"offer__image-wrapper",children:r.img&&e.jsx("img",{className:"offer__image",src:r.img,alt:"Photo studio"})});function B({offerId:r,images:a}){return e.jsx("div",{className:"offer__gallery-container container",children:e.jsx("div",{className:"offer__gallery",children:a&&a.slice(0,6).map(t=>e.jsx(U,{img:t},r+t))})})}const q=_.memo(B),z=[{value:5,label:"perfect"},{value:4,label:"good"},{value:3,label:"not bad"},{value:2,label:"badly"},{value:1,label:"terribly"}],p={Min:50,Max:300},j={rating:"0",review:""};function W({offerId:r}){const[a,t]=_.useState(j),s=g(),l=c(w),m=i=>{const{name:d,value:h}=i.target;t({...a,[d]:h})},o=()=>{t(j)},f=a.review.length<p.Min||a.rating==="0"||a.review.length>p.Max,x=i=>{i.preventDefault(),s(b({comment:a.review,rating:Number.parseInt(a.rating,10),offerId:r,clearReviewForm:o}))};return e.jsxs("form",{className:"reviews__form form",action:"#",method:"post",onSubmit:x,children:[e.jsx("label",{className:"reviews__label form__label",htmlFor:"review",children:"Your review"}),e.jsx("div",{className:"reviews__rating-form form__rating",children:z.map(({value:i,label:d})=>e.jsxs(_.Fragment,{children:[e.jsx("input",{className:"form__rating-input visually-hidden",name:"rating",value:i,id:`${i}-stars`,type:"radio",onChange:m,checked:i===Number.parseInt(a.rating,10),disabled:l}),e.jsx("label",{htmlFor:`${i}-stars`,className:"reviews__rating-label form__rating-label",title:d,children:e.jsx("svg",{className:"form__star-image",width:"37",height:"33",children:e.jsx("use",{xlinkHref:"#icon-star"})})})]},i+d))}),e.jsx("textarea",{className:"reviews__textarea form__textarea",id:"review",name:"review",placeholder:"Tell how was your stay, what you like and what can be improved",onChange:m,value:a.review,disabled:l}),e.jsxs("div",{className:"reviews__button-wrapper",children:[e.jsxs("p",{className:"reviews__help",children:["To submit review please make sure to set "," ",e.jsx("span",{className:"reviews__star",children:"rating "}),"and describe your stay with at least "," ",e.jsx("b",{className:"reviews__text-amount",children:"50 characters"}),"."]}),e.jsx("button",{className:"reviews__submit form__submit button",type:"submit",disabled:f||l,children:"Submit"})]})]})}function J({name:r,comment:a,avatarUrl:t,rating:s,date:l}){return e.jsxs("li",{className:"reviews__item",children:[e.jsxs("div",{className:"reviews__user user",children:[e.jsx("div",{className:"reviews__avatar-wrapper user__avatar-wrapper",children:e.jsx("img",{className:"reviews__avatar user__avatar",src:t,width:"54",height:"54",alt:"Reviews avatar"})}),e.jsx("span",{className:"reviews__user-name",children:r})]}),e.jsxs("div",{className:"reviews__info",children:[e.jsx("div",{className:"reviews__rating rating",children:e.jsxs("div",{className:"reviews__stars rating__stars",children:[e.jsx("span",{style:{width:`${s*20}%`}}),e.jsx("span",{className:"visually-hidden",children:"Rating"})]})}),e.jsx("p",{className:"reviews__text",children:a}),e.jsx("time",{className:"reviews__time",dateTime:u(l).format("YYYY-MM-DD"),children:u(l).format("MMMM YYYY")})]})]})}function K({reviews:r}){const a=r.slice(0,10),t=c(y);return e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"reviews__title",children:["Reviews · ",e.jsx("span",{className:"reviews__amount",children:r.length})]}),t&&e.jsx(N,{}),!t&&e.jsx("ul",{className:"reviews__list",children:a.map(s=>e.jsx(J,{rating:s.rating,date:s.date,comment:s.comment,name:s.user.name,avatarUrl:s.user.avatarUrl},s.id))})]})}function Q({isAuth:r,reviews:a,offerId:t}){return e.jsxs(e.Fragment,{children:[e.jsx(K,{reviews:a}),r&&e.jsx(W,{offerId:t})]})}function V({goodsItem:r}){return e.jsx("li",{className:"offer__inside-item",children:r})}function Z({authorizationStatus:r}){const a=c(O),t=c(I),s=c(R),l=c(M),m=c(A),o=g(),f=c(L),i=C().id;if(_.useEffect(()=>{i&&(o(S({id:i})),o(D({id:i})),o(P({id:i})))},[i,o]),f)return e.jsx(T,{});if(a||t||!s)return e.jsx(N,{});const d=v.find(n=>n.title===s.city.name)??v[0],h=[...l,s];return e.jsx(E,{page:"offer",children:e.jsxs("main",{className:"page__main page__main--offer",children:[e.jsxs("section",{className:"offer",children:[e.jsx(q,{offerId:s.id,images:s.images},`${s.id}gallery`),e.jsx("div",{className:"offer__container container",children:e.jsxs("div",{className:"offer__wrapper",children:[s.isPremium&&e.jsx("div",{className:"offer__mark",children:e.jsx("span",{children:"Premium"})}),e.jsxs("div",{className:"offer__name-wrapper",children:[e.jsx("h1",{className:"offer__name",children:s.title}),e.jsx(Y,{offerId:s.id,cardType:"favorite"})]}),e.jsxs("div",{className:"offer__rating rating",children:[e.jsxs("div",{className:"offer__stars rating__stars",children:[e.jsx("span",{style:{width:`${k(Math.round(s.rating))}%`}}),e.jsx("span",{className:"visually-hidden",children:"Rating"})]}),e.jsx("span",{className:"offer__rating-value rating__value",children:s.rating})]}),e.jsxs("ul",{className:"offer__features",children:[e.jsx("li",{className:"offer__feature offer__feature--entire",children:s.type}),e.jsxs("li",{className:"offer__feature offer__feature--bedrooms",children:[s.bedrooms," Bedrooms"]}),e.jsxs("li",{className:"offer__feature offer__feature--adults",children:["Max ",s.maxAdults," adults"]})]}),e.jsxs("div",{className:"offer__price",children:[e.jsxs("b",{className:"offer__price-value",children:["€",s.price]}),e.jsx("span",{className:"offer__price-text",children:" night"})]}),e.jsxs("div",{className:"offer__inside",children:[e.jsx("h2",{className:"offer__inside-title",children:"What's inside"}),e.jsx("ul",{className:"offer__inside-list",children:s.goods&&s.goods.map(n=>e.jsx(V,{goodsItem:n},s.id+n))})]}),e.jsxs("div",{className:"offer__host",children:[e.jsx("h2",{className:"offer__host-title",children:"Meet the host"}),e.jsxs("div",{className:"offer__host-user user",children:[e.jsx("div",{className:F(s.host.isPro&&"offer__avatar-wrapper--pro","offer__avatar-wrapper","user__avatar-wrapper"),children:e.jsx("img",{className:"offer__avatar user__avatar",src:s.host.avatarUrl,width:"74",height:"74",alt:"Host avatar"})}),e.jsx("span",{className:"offer__user-name",children:s.host.name}),s.host.isPro&&e.jsx("span",{className:"offer__user-status",children:" Pro "})]}),e.jsx("div",{className:"offer__description",children:e.jsx("p",{className:"offer__text",children:s.description})})]}),e.jsx("section",{className:"offer__reviews reviews",children:i&&e.jsx(Q,{reviews:m,isAuth:r===$.Auth,offerId:i})})]})}),e.jsx(G,{city:d,offers:h,currentOfferId:s.id,className:"offer__map"})]}),e.jsx("div",{className:"container",children:e.jsxs("section",{className:"near-places places",children:[e.jsx("h2",{className:"near-places__title",children:"Other places in the neighbourhood"}),e.jsx("div",{className:"near-places__list places__list",children:l.map(n=>e.jsx(H,{title:n.title,type:n.type,id:n.id,image:n.previewImage,price:n.price,rating:n.rating,cardType:"near",isPremium:n.isPremium},n.id))})]})})]})})}export{Z as default};
